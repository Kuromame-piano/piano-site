---
import Layout from "../../layouts/Layout.astro";
import { areas } from "../../data/areas";
import { type Area } from "../../data/areas";

export async function getStaticPaths() {
    return areas.map((area) => ({
        params: { slug: area.slug },
        props: { area },
    }));
}

interface Props {
    area: Area;
}

const { area } = Astro.props;

const pageTitle = `${area.name}の出張ピアノ教室 | 髙橋遊月ピアノ教室`;
const pageDescription = `${area.name}（${area.subAreas.join(
    "・",
)}）での出張ピアノレッスン。${area.lead}`;

// Schema.org Structured Data
const schema = JSON.stringify({
    "@context": "https://schema.org",
    "@graph": [
        {
            "@type": "BreadcrumbList",
            itemListElement: [
                {
                    "@type": "ListItem",
                    position: 1,
                    item: {
                        "@id": Astro.site?.toString(),
                        name: "ホーム",
                    },
                },
                {
                    "@type": "ListItem",
                    position: 2,
                    item: {
                        "@id": new URL("/#areas", Astro.site).toString(),
                        name: "出張エリア",
                    },
                },
                {
                    "@type": "ListItem",
                    position: 3,
                    item: {
                        "@id": Astro.url.toString(),
                        name: area.name,
                    },
                },
            ],
        },
        {
            "@type": "Service",
            name: `${area.name}の出張ピアノ教室`,
            provider: {
                "@type": "MusicSchool",
                name: "髙橋遊月ピアノ教室",
                url: Astro.site?.toString(),
                image: new URL("/senzai.png", Astro.site).toString(),
            },
            areaServed: [
                {
                    "@type": "City",
                    name: area.name,
                },
                ...area.subAreas.map((sub) => ({
                    "@type": "Place",
                    name: sub,
                })),
            ],
            description: area.lead,
            url: Astro.url.toString(),
        },
    ],
});
---

<Layout
    title={pageTitle}
    description={pageDescription}
    image={area.mainImage}
    keywords={area.keywords}
>
    <!-- Structured Data -->
    <script slot="head" type="application/ld+json" set:html={schema} />
    <div
        class="relative h-[60vh] flex items-center justify-center overflow-hidden"
    >
        <div class="absolute inset-0 z-0">
            <img
                src={area.mainImage}
                alt={`${area.name}の街並み`}
                class="w-full h-full object-cover opacity-60"
            />
            <div class="absolute inset-0 bg-[#544A40]/30"></div>
        </div>

        {/* Breadcrumbs (Visual) */}
        <div class="absolute top-24 left-0 right-0 z-20 px-6">
            <nav
                class="max-w-4xl mx-auto text-sm text-white/90 font-light"
                aria-label="Breadcrumb"
            >
                <ol class="flex items-center space-x-2">
                    <li>
                        <a href="/" class="hover:text-white transition-colors"
                            >ホーム</a>
                    </li>
                    <li><span class="opacity-60">/</span></li>
                    <li><span class="opacity-60">出張エリア</span></li>
                    <li><span class="opacity-60">/</span></li>
                    <li class="font-medium text-white" aria-current="page">
                        {area.name}
                    </li>
                </ol>
            </nav>
        </div>
        <div class="relative z-10 text-center text-white px-6">
            <h1 class="text-3xl md:text-5xl font-serif mb-4 tracking-wider">
                {area.name}
            </h1>
            <p class="text-lg md:text-xl font-light opacity-90">
                Area Information
            </p>
        </div>
    </div>

    <section class="py-20 px-6 max-w-4xl mx-auto">
        <div class="text-center mb-16">
            <h2
                class="text-2xl md:text-3xl font-serif mb-8 text-[#544A40] leading-relaxed"
            >
                {area.catchphrase}
            </h2>
            <p class="text-[#544A40]/80 leading-8">
                {area.lead}
            </p>
        </div>

        <div class="space-y-16">
            {
                area.features.map((feature, index) => (
                    <div
                        class={`flex flex-col md:flex-row gap-8 items-center ${index % 2 === 1 ? "md:flex-row-reverse" : ""}`}
                    >
                        <div class="flex-1 space-y-4">
                            <h3 class="text-xl font-serif text-[#A88B58] border-l-4 border-[#A88B58] pl-4">
                                {feature.title}
                            </h3>
                            <p class="text-[#544A40]/80 leading-7 text-justify">
                                {feature.description}
                            </p>
                        </div>
                    </div>
                ))
            }
        </div>
    </section>

    <section class="bg-[#F3EFE9] py-20 px-6">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-2xl font-serif mb-8 text-[#544A40]">
                {area.name}のアクセス・対応エリア
            </h2>
            <p class="mb-4 text-[#544A40]/90 font-medium">
                {area.access}
            </p>
            <div class="flex flex-wrap justify-center gap-2 mb-8">
                {
                    area.keywords.map((keyword) => (
                        <span class="bg-white px-3 py-1 text-sm text-[#A88B58] rounded-full border border-[#A88B58]/20">
                            #{keyword}
                        </span>
                    ))
                }
            </div>
        </div>
    </section>

    <section class="py-20 px-6 max-w-4xl mx-auto text-center">
        <h2 class="text-xl font-serif mb-8 text-[#544A40] opacity-60">
            他のエリアを見る
        </h2>
        <div class="flex flex-wrap justify-center gap-4 text-sm">
            {
                areas.map(
                    (a) =>
                        a.slug !== area.slug && (
                            <a
                                href={`/area/${a.slug}`}
                                class="block px-6 py-3 border border-[#544A40]/20 text-[#544A40] hover:bg-[#544A40] hover:text-white transition-colors duration-300"
                            >
                                {a.name}
                            </a>
                        ),
                )
            }
        </div>
    </section>
</Layout>
